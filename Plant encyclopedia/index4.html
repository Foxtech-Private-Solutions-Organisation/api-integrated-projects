<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Plant Identifier</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f8f5;
      padding: 20px;
    }
    h1 {
      color: green;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h1>🌱 Plant Identifier</h1>
  <p>Upload a plant image to identify it.</p>

  <input type="file" id="plantImage" accept="image/*">
  <button onclick="identifyPlant()">Identify Plant</button>

  <div id="output" class="result"></div>

  <script>
    async function identifyPlant() {
      const fileInput = document.getElementById("plantImage");
      if (!fileInput.files.length) {
        alert("Please select an image first!");
        return;
      }

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onloadend = async () => {
        const base64Image = reader.result.split(",")[1];

        const response = await fetch("https://plant.id/api/v3/identification", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Api-Key": "lKgGkhwUI4riO5ydDvrpAJqLNsYFjS9wAAN1dbXfMkhafS26YD"  // ⚠️ For demo only!
          },
          body: JSON.stringify({
            images: [base64Image],
            similar_images: true,
            plant_details: ["common_names", "url", "taxonomy", "wiki_description", "edible_parts", "watering"]
          })
        });

        const data = await response.json();
        console.log(data);

        const output = document.getElementById("output");
        if (data.suggestions && data.suggestions.length > 0) {
          const plant = data.suggestions[0];
          const details = plant.plant_details;

          output.innerHTML = `
            <h3>🌿 Result: ${plant.plant_name}</h3>
            <p><b>Probability:</b> ${(plant.probability * 100).toFixed(2)}%</p>
            <p><b>Scientific name:</b> ${details.scientific_name || "N/A"}</p>
            <p><b>Common names:</b> ${details.common_names ? details.common_names.join(", ") : "N/A"}</p>
            <p><b>Family:</b> ${details.taxonomy?.family || "N/A"}</p>
            <p><b>Genus:</b> ${details.taxonomy?.genus || "N/A"}</p>
            <p><b>Wiki description:</b> ${details.wiki_description?.value || "N/A"}</p>
            <p><b>Edible parts:</b> ${details.edible_parts ? details.edible_parts.join(", ") : "None"}</p>
            <p><b>Watering:</b> ${details.watering?.max || "N/A"} ml/week</p>
            <p><a href="${details.url}" target="_blank">🔗 More info</a></p>
          `;
        } else {
          output.innerHTML = "<p>No plant identified. Try another image.</p>";
        }
      };

      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
