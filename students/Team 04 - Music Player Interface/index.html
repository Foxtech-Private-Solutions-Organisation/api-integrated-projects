<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Music Player with Login</title>
		<style>
			body,
			html {
				margin: 0;
				height: 100%;
				font-family: "Poppins", sans-serif;
				background: linear-gradient(-45deg, #191414, #1db954, #0f2027, #203a43);
				background-size: 400% 400%;
				animation: gradientBG 15s ease infinite;
				color: white;
				display: flex;
				justify-content: center;
				align-items: center;
			}
			@keyframes gradientBG {
				0% {
					background-position: 0% 50%;
				}
				50% {
					background-position: 100% 50%;
				}
				100% {
					background-position: 0% 50%;
				}
			}
			.card {
				background: rgba(0, 0, 0, 0.85);
				padding: 20px;
				border-radius: 15px;
				width: 400px;
				text-align: center;
				box-shadow: 0 0 25px rgba(103, 211, 141, 0.4);
			}
			h2 {
				color: #1db954;
				margin-bottom: 15px;
			}
			input {
				width: 100%;
				padding: 10px;
				margin: 8px 0;
				border-radius: 8px;
				border: none;
				outline: none;
			}
			button {
				background: #1db954;
				border: none;
				padding: 10px 15px;
				margin: 5px;
				border-radius: 8px;
				cursor: pointer;
				font-size: 16px;
				transition: 0.3s;
			}
			button:hover {
				background: #96e6b2;
			}
			#controls button {
				font-size: 18px;
			}
			#seekBar {
				width: 100%;
				margin: 10px 0;
			}
			#timeInfo {
				display: flex;
				justify-content: space-between;
				font-size: 13px;
				color: #bbb;
			}
			#queue {
				margin-top: 15px;
				max-height: 150px;
				overflow-y: auto;
				text-align: left;
			}
			#queue p {
				padding: 8px;
				border-radius: 6px;
				cursor: pointer;
				transition: 0.3s;
			}
			#queue p:hover {
				background: rgba(29, 185, 84, 0.2);
			}
			#queue .active {
				background: rgba(29, 185, 84, 0.5);
				font-weight: bold;
			}
		</style>
	</head>
	<body>
		<!-- Login Page -->
		<div class="card" id="loginPage">
			<h2>üîê Spotify</h2>
			<input type="text" id="username" placeholder="Enter Username" />
			<input type="password" id="password" placeholder="Enter Password" />
			<button onclick="login()">Login</button>
			<p id="loginMsg" style="color: red; font-size: 14px"></p>
		</div>

		<!-- Music Player -->
		<div class="card" id="playerPage" style="display: none">
			<h2>üé∂ Spotify Player</h2>
			<input type="text" id="searchBar" placeholder="Search songs..." />
			<button onclick="searchSongs()">Search</button>
			<p id="trackInfo">Search to play songs üéµ</p>
			<input type="range" id="seekBar" value="0" />
			<div id="timeInfo">
				<span id="currentTime">0:00</span>
				<span id="duration">0:00</span>
			</div>
			<div id="controls">
				<button id="prevBtn">‚èÆÔ∏è</button>
				<button id="playPauseBtn">‚ñ∂Ô∏è</button>
				<button id="nextBtn">‚è≠Ô∏è</button>
			</div>
			<div id="queue"></div>
		</div>

		<audio id="audioPlayer"></audio>

		<script>
			// ================== LOGIN ==================
			function login() {
				const user = document.getElementById("username").value;
				const pass = document.getElementById("password").value;
				if (user && pass) {
					document.getElementById("loginPage").style.display = "none";
					document.getElementById("playerPage").style.display = "block";
				} else {
					document.getElementById("loginMsg").textContent = "Enter username & password!";
				}
			}

			// ================== MUSIC PLAYER ==================
			const searchBar = document.getElementById("searchBar");
			const trackInfo = document.getElementById("trackInfo");
			const seekBar = document.getElementById("seekBar");
			const currentTimeEl = document.getElementById("currentTime");
			const durationEl = document.getElementById("duration");
			const queueEl = document.getElementById("queue");
			const audioPlayer = document.getElementById("audioPlayer");
			const playPauseBtn = document.getElementById("playPauseBtn");

			let tracks = [];
			let currentTrackIndex = 0;
			let isPlaying = false;

			async function searchSongs() {
				const query = searchBar.value.trim();
				if (!query) return;
				try {
					const res = await fetch(
						`https://itunes.apple.com/search?term=${encodeURIComponent(
							query
						)}&media=music&limit=10`
					);
					const data = await res.json();

					tracks = data.results.map((song) => ({
						title: song.trackName,
						artist: song.artistName,
						preview: song.previewUrl,
					}));

					queueEl.innerHTML = "";
					tracks.forEach((t, i) => {
						const p = document.createElement("p");
						p.textContent = `${t.title} - ${t.artist}`;
						p.addEventListener("click", () => {
							currentTrackIndex = i;
							playTrack(currentTrackIndex);
						});
						queueEl.appendChild(p);
					});

					if (tracks.length > 0) playTrack(0);
					else trackInfo.textContent = "No results found.";
				} catch (e) {
					alert("Error fetching songs.");
					console.error(e);
				}
			}

			function playTrack(index) {
				const track = tracks[index];
				if (!track || !track.preview) return;
				audioPlayer.src = track.preview;
				audioPlayer.play();
				trackInfo.textContent = `Playing: ${track.title} - ${track.artist}`;
				playPauseBtn.textContent = "‚è∏Ô∏è";
				isPlaying = true;
				updateQueueUI();
			}

			playPauseBtn.addEventListener("click", () => {
				if (isPlaying) {
					audioPlayer.pause();
					playPauseBtn.textContent = "‚ñ∂Ô∏è";
					isPlaying = false;
				} else {
					audioPlayer.play();
					playPauseBtn.textContent = "‚è∏Ô∏è";
					isPlaying = true;
				}
			});

			document.getElementById("nextBtn").addEventListener("click", () => {
				currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
				playTrack(currentTrackIndex);
			});

			document.getElementById("prevBtn").addEventListener("click", () => {
				currentTrackIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
				playTrack(currentTrackIndex);
			});

			function updateQueueUI() {
				const items = queueEl.querySelectorAll("p");
				items.forEach((item, i) => {
					item.classList.remove("active");
					if (i === currentTrackIndex) item.classList.add("active");
				});
			}

			// Seekbar
			audioPlayer.addEventListener("timeupdate", () => {
				seekBar.value = (audioPlayer.currentTime / audioPlayer.duration) * 100 || 0;
				currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
				durationEl.textContent = formatTime(audioPlayer.duration);
			});

			seekBar.addEventListener("input", () => {
				audioPlayer.currentTime = (seekBar.value / 100) * audioPlayer.duration;
			});

			function formatTime(seconds) {
				if (isNaN(seconds)) return "0:00";
				let m = Math.floor(seconds / 60);
				let s = Math.floor(seconds % 60);
				return `${m}:${s < 10 ? "0" + s : s}`;
			}
		</script>
	</body>
</html>
